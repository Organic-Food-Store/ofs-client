<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="app-theme.html">
<dom-module id="order-selector">
    <style include="app-theme">
        :host {}
    </style>
    <template>
        <firebase-document path="/users/[[orderUserId]]/orders" data="{{orderData}}"></firebase-document>
        <total-price tracking user-id="[[orderData.userid]]" store-id="[[orderData.storeId]]" quantities="[[orderData.cart]]" cart-total="{{orderTotal}}"></total-price>
        <general-selector repeat-items="[[orderDataParsed]]" selected="{{orderId}}" store></general-selector>
    </template>
    <script>
        Polymer({
            is: 'order-selector',
            properties: {
                orderDataParsed: {
                    type: Array,
                    notify: true,
                    computed: "parsedOrderData(orderData, orderTotal)"
                },
                orderId: {
                    observer: "orderIdChanged"
                }
            },
            orderIdChanged: function (value) {
                console.log("value");
                console.log(value);
                console.log("this.orderId");
                console.log(this.orderId);
            },
            parsedOrderData: function (data, total) {
                var rtn = [];
                for (var order in data) if(order!="new") rtn.push({
                    "id": order,
                    "icon": "receipt",
                    "firstLine": order,
                    "secondLine": "Status: "+data[order].status,
                    "thirdLine": (new Date(data[order].timestamp)).toLocaleString(),
                    "xtraData": total
                });
                console.log(rtn);
                return rtn;
            }
        });
    </script>
</dom-module>